<Window x:Class="Demo_MVVM.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Logic.Ui.ViewModels;assembly=Logic.Ui"
        mc:Ignorable="d"
        Title="{Binding AppTitle}" Height="420" Width="640">
    <Window.Resources>
        <vm:MainViewModel x:Key="MainVM" />
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Window.Resources>

    <Window.DataContext>
        <StaticResource ResourceKey="MainVM" />
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <DockPanel Grid.Row="0" LastChildFill="False" Margin="8">
            <TextBlock Text="{Binding AppTitle}" FontWeight="Bold" FontSize="14" VerticalAlignment="Center"/>
            <Button DockPanel.Dock="Right" Margin="8,0,0,0" Content="About" Command="{Binding ToggleAboutCommand}"/>
        </DockPanel>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" Margin="8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Greeting demo -->
                <GroupBox Header="Greeting" Padding="8" Grid.Row="0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" >
                        <TextBlock Text="Name:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBox Width="240"
                                 Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <Button Content="Greet"
                                Margin="8,0,0,0"
                                Command="{Binding GreetCommand}"/>
                        <TextBlock Text="{Binding Greeting}" Margin="12,0,0,0" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="DarkGreen"/>
                    </StackPanel>
                </GroupBox>

                <!-- Counter demo -->
                <GroupBox Header="Counter" Padding="8" Grid.Row="2">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Count:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="{Binding Count}" FontWeight="Bold" Width="50" TextAlignment="Center" VerticalAlignment="Center"/>
                        <Button Content="+" Width="36" Margin="8,0,0,0" Command="{Binding IncrementCommand}"/>
                        <Button Content="-" Width="36" Margin="8,0,0,0" Command="{Binding DecrementCommand}"/>
                        <Button Content="Reset" Margin="8,0,0,0" Command="{Binding ResetCommand}"/>
                    </StackPanel>
                </GroupBox>

                <!-- Async demo -->
                <GroupBox Header="Async demo" Padding="8" Grid.Row="4">
                    <StackPanel Orientation="Horizontal">
                        <Button Content="Load Data (1s)" Command="{Binding LoadDataCommand}"/>
                        <ProgressBar Margin="12,0,0,0" Width="160" IsIndeterminate="True"
                                     Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"/>
                        <TextBlock Margin="12,0,0,0" VerticalAlignment="Center" Text="{Binding LastLoadedAt}"/>
                    </StackPanel>
                </GroupBox>

                <!-- About overlay -->
                <Border Background="#80000000"
                        Visibility="{Binding IsAboutOpen, Converter={StaticResource BoolToVis}}"
                        Grid.RowSpan="5">
                    <Border HorizontalAlignment="Center" VerticalAlignment="Center"
                            Padding="16" Background="White" CornerRadius="6" Width="380">
                        <StackPanel>
                            <TextBlock Text="About this demo" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                            <TextBlock Text="• Pattern: MVVM (no code-behind UI logic)" Margin="0,0,0,4"/>
                            <TextBlock Text="• ViewModels in Logic.Ui" Margin="0,0,0,4"/>
                            <TextBlock Text="• Commands and async example" Margin="0,0,0,12"/>
                            <Button Content="Close" HorizontalAlignment="Right" Width="80" Command="{Binding ToggleAboutCommand}"/>
                        </StackPanel>
                    </Border>
                </Border>
            </Grid>
        </ScrollViewer>

        <!-- Status bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem Content="{Binding Status}" />
        </StatusBar>
    </Grid>
</Window>